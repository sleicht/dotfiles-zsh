# Requirements Archive: v1.2 Legacy Cleanup

**Archived:** 2026-02-14
**Status:** SHIPPED

For current requirements, see `.planning/REQUIREMENTS.md`.

---

# Requirements: Dotfiles Stack

**Defined:** 2026-02-13
**Core Value:** Cross-platform dotfiles that "just work" -- one repository that handles Mac vs Linux differences through templating, without requiring Nix expertise to maintain.

## v1.2 Requirements

Requirements for Legacy Cleanup milestone. Removes pre-chezmoi artifacts and fixes stale code in chezmoi source.

### Legacy Files

- [ ] **LEGACY-01**: Remove all 10 legacy .config/ directories (aerospace, atuin, bat, btop, claude, ghostty, git, karabiner, lsd, zsh-abbr)
- [ ] **LEGACY-02**: Remove all 17 legacy .config/ flat files (aider.conf.yml, editorconfig, finicky.js, gpgagent, hushlogin, inputrc, kitty.conf, lazygit.yml, nanorc, oh-my-posh.omp.json, psqlrc, sqliterc, ssh_config, wezterm.lua, zprofile, zshenv, zshrc)
- [ ] **LEGACY-03**: Migrate san-proxy sourcing from .config/profile to chezmoi with client-only conditional template
- [ ] **LEGACY-04**: Remove redundant zsh.d/ directory (chezmoi manages dot_zsh.d/)
- [ ] **LEGACY-05**: Remove all three legacy Brewfiles (Brewfile, Brewfile_Client, Brewfile_Fanaka)

### Chezmoi Source Fixes

- [ ] **CHEZFIX-01**: Remove Volta PATH and VOLTA_HOME from chezmoi path.zsh.tmpl
- [ ] **CHEZFIX-02**: Remove rbenv PATH from chezmoi path.zsh.tmpl
- [ ] **CHEZFIX-03**: Remove dual mise activation (keep in external.zsh, remove from hooks.zsh)
- [ ] **CHEZFIX-04**: Remove commented-out asdf activation from chezmoi hooks.zsh
- [ ] **CHEZFIX-05**: Fix omz reload alias to use exec shell reload in chezmoi aliases.zsh
- [ ] **CHEZFIX-06**: Fix Python 2 server() function to use Python 3 http.server in chezmoi functions.zsh
- [ ] **CHEZFIX-07**: Fix Python 2 urlencode alias to use Python 3 urllib.parse in chezmoi aliases.zsh
- [ ] **CHEZFIX-08**: Clean stale npm/gem commands from update alias in chezmoi aliases.zsh
- [ ] **CHEZFIX-09**: Remove empty "Version managers" section from chezmoi variables.zsh
- [ ] **CHEZFIX-10**: Remove hardcoded /usr/local npm PATH from chezmoi variables.zsh

### Misc Cleanup

- [ ] **MISC-01**: Remove empty bin/ directory
- [ ] **MISC-02**: Delete firebase-debug.log and add to .gitignore
- [ ] **MISC-03**: Remove logs/ directory
- [ ] **MISC-04**: Remove stale dotbot/zgenom directory references from audit-gitleaks.toml
- [ ] **MISC-05**: Remove stale dotbot directory references from audit-secrets.sh
- [ ] **MISC-06**: Update verify-backup.sh critical files list for chezmoi layout

## Future Requirements

### Performance (deferred to v2.0)

- **PERF-01**: Profile shell startup with zprof and establish baseline
- **PERF-02**: Implement lazy loading for non-critical tool initialisation
- **PERF-03**: Add eval caching for expensive startup commands
- **PERF-04**: Achieve < 300ms total shell startup time
- **MISE-03**: Set up mise task runner for common development tasks

## Out of Scope

| Feature | Reason |
|---------|--------|
| Removing .config/ from git history | Rewriting history is destructive; files just need removing from HEAD |
| Migrating Brewfile_Client/Brewfile_Fanaka content | Already in .chezmoidata.yaml; legacy files just need deleting |
| Fixing phantom/firebase-cli shebangs | Requires Homebrew node reinstall or mise shim; deferred to v2.0 |
| Removing nushell from .chezmoidata.yaml | Still installed as a brew package; only config was deprecated |

## Traceability

Which phases cover which requirements. Updated during roadmap creation.

| Requirement | Phase | Status |
|-------------|-------|--------|
| LEGACY-01 | Phase 13 | Pending |
| LEGACY-02 | Phase 13 | Pending |
| LEGACY-03 | Phase 14 | Pending |
| LEGACY-04 | Phase 13 | Pending |
| LEGACY-05 | Phase 13 | Pending |
| CHEZFIX-01 | Phase 15 | Pending |
| CHEZFIX-02 | Phase 15 | Pending |
| CHEZFIX-03 | Phase 15 | Pending |
| CHEZFIX-04 | Phase 15 | Pending |
| CHEZFIX-05 | Phase 16 | Pending |
| CHEZFIX-06 | Phase 16 | Pending |
| CHEZFIX-07 | Phase 16 | Pending |
| CHEZFIX-08 | Phase 16 | Pending |
| CHEZFIX-09 | Phase 15 | Pending |
| CHEZFIX-10 | Phase 15 | Pending |
| MISC-01 | Phase 17 | Pending |
| MISC-02 | Phase 17 | Pending |
| MISC-03 | Phase 17 | Pending |
| MISC-04 | Phase 17 | Pending |
| MISC-05 | Phase 17 | Pending |
| MISC-06 | Phase 17 | Pending |

**Coverage:**
- v1.2 requirements: 21 total
- Mapped to phases: 21 (100%)
- Unmapped: 0

---
*Requirements defined: 2026-02-13*
*Last updated: 2026-02-13 after roadmap creation*
