---
phase: 01-preparation-safety-net
plan: 04
type: execute
wave: 2
depends_on: ["01-01", "01-02", "01-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User has verified backup exists on external drive"
    - "User has confirmed critical files are present in backup"
    - "User has tested recovery script shows expected prompts"
    - "User has verified Linux test container starts"
  artifacts: []
  key_links: []
---

<objective>
Execute initial backup and verify all safety infrastructure works correctly.

Purpose: Validate that backup, recovery, verification, and test environment scripts all function before starting migration. This is the "trust but verify" step.

Output: Confirmed working safety net - backup on external drive, tested recovery path, working Linux environment.
</objective>

<execution_context>
@/Users/stephanlv_fanaka/.claude/get-shit-done/workflows/execute-plan.md
@/Users/stephanlv_fanaka/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-preparation-safety-net/01-CONTEXT.md
@.planning/phases/01-preparation-safety-net/01-01-SUMMARY.md
@.planning/phases/01-preparation-safety-net/01-02-SUMMARY.md
@.planning/phases/01-preparation-safety-net/01-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run backup dry-run and display results</name>
  <files></files>
  <action>
Execute backup script in dry-run mode to show what would be backed up:

1. Ensure external drive is mounted (check `/Volumes/` for expected drive)
2. Run: `./scripts/backup-dotfiles.sh --dry-run`
3. Capture and display output including:
   - Pre-flight scan results (large files detected)
   - List of files that would be transferred
   - Statistics summary

This validates the backup script works without actually transferring files.
If drive not mounted, report the error message the script produces.
  </action>
  <verify>
Backup script runs and produces output (even if drive not mounted, it should error gracefully)
  </verify>
  <done>Backup dry-run completed or graceful error if drive not mounted</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Backup infrastructure (Plans 01-03):
- `scripts/backup-dotfiles.sh` - rsync backup with pre-flight checks
- `scripts/restore-dotfiles.sh` - interactive category-based recovery
- `scripts/verify-backup.sh` - backup completeness validation
- `scripts/test-linux.sh` - Linux test environment management
- `.docker/Dockerfile.dotfiles-test` - Ubuntu test container

Task 1 ran a dry-run of the backup script.
  </what-built>
  <how-to-verify>
**Step 1: Verify backup works**
1. Connect your external backup drive
2. Run: `./scripts/backup-dotfiles.sh` (dry-run mode)
3. Review the pre-flight scan output - any unexpected large files?
4. When satisfied, run: `./scripts/backup-dotfiles.sh --execute`
5. Wait for backup to complete

**Step 2: Verify backup completeness**
1. Run: `./scripts/verify-backup.sh`
2. Confirm all critical files are present
3. Note the file counts and backup timestamp

**Step 3: Test recovery script (DO NOT ACTUALLY RESTORE)**
1. Run: `./scripts/restore-dotfiles.sh`
2. When prompted for first category, type "skip"
3. Continue skipping to verify all categories appear
4. Type "no" to exit cleanly

**Step 4: Test Linux environment**
1. Run: `./scripts/test-linux.sh build` (builds Docker image)
2. Run: `./scripts/test-linux.sh start` (starts container)
3. Inside container, verify: `which zsh`, `which git`
4. Exit with: `exit`
5. Clean up: `./scripts/test-linux.sh clean`

**Expected results:**
- Backup completes with files on external drive
- Verification shows all critical files present
- Recovery script shows interactive prompts
- Linux container starts with zsh available
  </how-to-verify>
  <resume-signal>
Type "approved" if all four verification steps pass.
If issues found, describe what failed (which step, what error).
  </resume-signal>
</task>

</tasks>

<verification>
Phase 1 success criteria from roadmap:
1. User has complete backup of current dotfiles state - VERIFIED by backup completion
2. User can run emergency recovery script - VERIFIED by recovery script test
3. User has working Linux test environment - VERIFIED by container test
4. User can verify backup completeness - VERIFIED by verification script
</verification>

<success_criteria>
1. Backup script executed successfully (or dry-run if drive unavailable)
2. User confirmed backup exists on external drive with critical files
3. User confirmed recovery script displays interactive prompts correctly
4. User confirmed Linux test container builds and starts
5. User approved all verification steps
</success_criteria>

<output>
After completion and user approval, create `.planning/phases/01-preparation-safety-net/01-04-SUMMARY.md`
</output>
