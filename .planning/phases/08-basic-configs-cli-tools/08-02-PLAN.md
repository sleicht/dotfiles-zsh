---
phase: 08-basic-configs-cli-tools
plan: 02
type: execute
wave: 2
depends_on: ["08-01"]
files_modified:
  - scripts/verify-checks/08-basic-configs.sh
autonomous: true

must_haves:
  truths:
    - "Verification script confirms all 13 Phase 8 configs exist as deployed files"
    - "CLI tools (bat, lsd, btop) can parse their chezmoi-managed configs"
    - "Database tools (psql, sqlite) load chezmoi-managed configs"
    - "Aerospace config validation passes on macOS"
    - "Shell abbreviations file exists and is non-empty"
    - "Verification runner discovers and executes Phase 8 checks"
  artifacts:
    - path: "scripts/verify-checks/08-basic-configs.sh"
      provides: "Phase 8 verification check file"
  key_links:
    - from: "scripts/verify-checks/08-basic-configs.sh"
      to: "scripts/verify-configs.sh"
      via: "Plugin discovery (verify-checks/*.sh glob)"
      pattern: "verify-configs.sh --phase 08 discovers 08-basic-configs.sh"
    - from: "scripts/verify-checks/08-basic-configs.sh"
      to: "scripts/verify-lib/check-exists.sh"
      via: "source helper"
      pattern: "check_file_exists function"
    - from: "scripts/verify-checks/08-basic-configs.sh"
      to: "scripts/verify-lib/check-parsable.sh"
      via: "source helper"
      pattern: "check_app_can_parse function"
---

<objective>
Create the Phase 8 verification check file and run full verification to confirm all 13 configs deploy correctly and are parsable by their respective applications.

Purpose: Validate the migration is complete and functional using the verification framework established in Phase 7.
Output: Passing verification check file at `scripts/verify-checks/08-basic-configs.sh`, all checks green.
</objective>

<execution_context>
@/Users/stephanlv_fanaka/.claude/get-shit-done/workflows/execute-plan.md
@/Users/stephanlv_fanaka/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-basic-configs-cli-tools/08-RESEARCH.md
@.planning/phases/07-preparation/07-02-SUMMARY.md
@.planning/phases/08-basic-configs-cli-tools/08-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Phase 8 verification check file</name>
  <files>scripts/verify-checks/08-basic-configs.sh</files>
  <action>
Create `scripts/verify-checks/08-basic-configs.sh` following the Phase 7 verification framework pattern. This file is auto-discovered by `scripts/verify-configs.sh` via the `verify-checks/*.sh` glob.

The check file must:
1. Use the helper functions from verify-lib (check_file_exists, check_app_can_parse, check_no_template_errors)
2. Set a non-zero exit code on ANY failure (the runner uses the exit code)
3. Track pass/fail counts and print results

**File existence checks (all 13 configs):**
- `$HOME/.hushlogin`
- `$HOME/.inputrc`
- `$HOME/.editorconfig`
- `$HOME/.nanorc`
- `$HOME/.psqlrc`
- `$HOME/.sqliterc`
- `$HOME/.config/bat/config`
- `$HOME/.config/lsd/config.yaml`
- `$HOME/.config/btop/btop.conf`
- `$HOME/.config/oh-my-posh.omp.json`
- `$HOME/.config/karabiner/karabiner.json`
- `$HOME/.config/zsh-abbr/user-abbreviations`
- `$HOME/.config/aerospace/aerospace.toml` (macOS only -- guard with `[[ "$OSTYPE" == darwin* ]]`)

**Not-a-symlink checks (all 13 configs):**
- Each file must be a regular file, NOT a symlink (`! test -L "$path"`)
- This confirms chezmoi replaced Dotbot symlinks with real files

**Template error checks:**
- Use `check_no_template_errors` on all 13 files to confirm no unprocessed `{{ }}` markers

**Application parsability checks:**
- `check_app_can_parse bat "$HOME/.config/bat/config"` -- bat validates its own config
- `check_app_can_parse lsd "$HOME/.config/lsd/config.yaml"` -- lsd version check
- `check_app_can_parse btop "$HOME/.config/btop/btop.conf"` -- btop config syntax check

**Note:** psql and sqlite parsability checks are NOT included because:
- psql requires a running PostgreSQL server (`psql -c '\set'` fails without one)
- sqlite3 parsability is implicit (file is loaded on start, `.help` always works)
- oh-my-posh, aerospace, karabiner, and zsh-abbr do not have CLI config validation commands

The script must be executable (`chmod +x`).
  </action>
  <verify>
```bash
# Script passes syntax check
bash -n scripts/verify-checks/08-basic-configs.sh

# Script is executable
test -x scripts/verify-checks/08-basic-configs.sh && echo "OK" || echo "FAIL"
```
  </verify>
  <done>Phase 8 verification check file exists at scripts/verify-checks/08-basic-configs.sh, passes bash syntax check, and is executable.</done>
</task>

<task type="auto">
  <name>Task 2: Run verification and confirm all checks pass</name>
  <files></files>
  <action>
Run the verification framework to confirm all Phase 8 checks pass:

```bash
./scripts/verify-configs.sh --phase 08 --verbose
```

Expected output: All checks pass (13 existence checks, 13 not-a-symlink checks, template error checks, 3 parsability checks).

If any check fails:
- **File not found:** Check `chezmoi managed --include=files` to see if the file is tracked, and `chezmoi diff` to see if it needs applying. Run `chezmoi apply` if needed.
- **Still a symlink:** Run `chezmoi apply` again. If still symlink, check .chezmoiignore for leftover ignore patterns.
- **Template errors:** File should be static (no templates). Check chezmoi source for accidental `.tmpl` suffix.
- **Parse failure:** Check app is installed (`command -v bat`). If missing, not a Phase 8 blocker (app installation is Homebrew's domain).

Also run the full verification suite (all phases) to confirm no regressions:
```bash
./scripts/verify-configs.sh
```

Finally, confirm Phase 8 success criteria from ROADMAP.md:
1. `chezmoi apply` deploys basic dotfiles (.hushlogin, .inputrc, .editorconfig, .nanorc): `ls -la ~/.hushlogin ~/.inputrc ~/.editorconfig ~/.nanorc`
2. CLI tools use chezmoi-managed configs: `bat --config-file ~/.config/bat/config --list-themes | head -1`
3. Aerospace deploys on macOS only: `chezmoi managed | grep aerospace`
4. Database tools have configs: `ls -la ~/.psqlrc ~/.sqliterc`
5. Shell abbreviations exist: `wc -l ~/.config/zsh-abbr/user-abbreviations`
  </action>
  <verify>
```bash
# Phase 8 verification passes
./scripts/verify-configs.sh --phase 08
echo "Exit code: $?"  # Expected: 0
```
  </verify>
  <done>All Phase 8 verification checks pass. The 5 ROADMAP success criteria are confirmed: basic dotfiles deploy, CLI tools use chezmoi configs, aerospace is macOS-conditional, database tool configs exist, shell abbreviations load.</done>
</task>

</tasks>

<verification>
1. `./scripts/verify-configs.sh --phase 08` exits with code 0 (all checks pass)
2. All 13 files exist at target paths and are NOT symlinks
3. bat, lsd, btop configs parsable by their respective apps
4. No unprocessed template markers in any deployed file
5. All 5 Phase 8 ROADMAP success criteria confirmed
</verification>

<success_criteria>
- scripts/verify-checks/08-basic-configs.sh exists, is executable, passes bash -n
- ./scripts/verify-configs.sh --phase 08 exits 0
- All 5 ROADMAP success criteria for Phase 8 are satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/08-basic-configs-cli-tools/08-02-SUMMARY.md`
</output>
