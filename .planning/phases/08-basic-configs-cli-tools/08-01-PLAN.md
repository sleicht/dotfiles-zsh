---
phase: 08-basic-configs-cli-tools
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - ~/.local/share/chezmoi/dot_hushlogin
  - ~/.local/share/chezmoi/dot_inputrc
  - ~/.local/share/chezmoi/dot_editorconfig
  - ~/.local/share/chezmoi/dot_nanorc
  - ~/.local/share/chezmoi/dot_psqlrc
  - ~/.local/share/chezmoi/dot_sqliterc
  - ~/.local/share/chezmoi/private_dot_config/bat/config
  - ~/.local/share/chezmoi/private_dot_config/lsd/config.yaml
  - ~/.local/share/chezmoi/private_dot_config/btop/btop.conf
  - ~/.local/share/chezmoi/private_dot_config/oh-my-posh.omp.json
  - ~/.local/share/chezmoi/private_dot_config/aerospace/aerospace.toml
  - ~/.local/share/chezmoi/private_dot_config/karabiner/karabiner.json
  - ~/.local/share/chezmoi/private_dot_config/zsh-abbr/user-abbreviations
  - ~/.local/share/chezmoi/.chezmoiignore
autonomous: true

must_haves:
  truths:
    - "All 13 Phase 8 configs exist in chezmoi source directory with correct naming"
    - "Phase 8 ignore block removed from .chezmoiignore"
    - ".editorconfig conflict between Section 2 and Section 8 resolved"
    - "chezmoi apply deploys real files (not symlinks) for all 13 configs"
    - "Existing Dotbot symlinks replaced with chezmoi-managed real files"
  artifacts:
    - path: "~/.local/share/chezmoi/dot_hushlogin"
      provides: "Home-level .hushlogin"
    - path: "~/.local/share/chezmoi/dot_inputrc"
      provides: "Readline configuration"
    - path: "~/.local/share/chezmoi/dot_editorconfig"
      provides: "Home-level editor config"
    - path: "~/.local/share/chezmoi/dot_nanorc"
      provides: "Nano editor config"
    - path: "~/.local/share/chezmoi/dot_psqlrc"
      provides: "PostgreSQL client config"
    - path: "~/.local/share/chezmoi/dot_sqliterc"
      provides: "SQLite client config"
    - path: "~/.local/share/chezmoi/private_dot_config/bat/config"
      provides: "bat syntax highlighter config"
    - path: "~/.local/share/chezmoi/private_dot_config/lsd/config.yaml"
      provides: "lsd directory listing config"
    - path: "~/.local/share/chezmoi/private_dot_config/btop/btop.conf"
      provides: "btop system monitor config"
    - path: "~/.local/share/chezmoi/private_dot_config/oh-my-posh.omp.json"
      provides: "oh-my-posh prompt theme"
    - path: "~/.local/share/chezmoi/private_dot_config/aerospace/aerospace.toml"
      provides: "AeroSpace window manager config"
    - path: "~/.local/share/chezmoi/private_dot_config/karabiner/karabiner.json"
      provides: "Karabiner keyboard remapping config"
    - path: "~/.local/share/chezmoi/private_dot_config/zsh-abbr/user-abbreviations"
      provides: "ZSH abbreviations"
    - path: "~/.local/share/chezmoi/.chezmoiignore"
      provides: "Updated ignore file without Phase 8 block"
  key_links:
    - from: "~/.local/share/chezmoi/dot_hushlogin"
      to: "~/.hushlogin"
      via: "chezmoi apply"
      pattern: "real file, not symlink"
    - from: ".chezmoiignore Section 8 removal"
      to: "chezmoi managed output"
      via: "chezmoi managed includes Phase 8 files"
      pattern: "chezmoi managed | grep hushlogin"
---

<objective>
Migrate all 13 Phase 8 configuration files from Dotbot symlinks to chezmoi source using `chezmoi add --follow`, update .chezmoiignore to remove the Phase 8 pending block, and apply to deploy real files.

Purpose: Replace Dotbot-managed symlinks with chezmoi-managed real files for basic dotfiles, CLI tool configs, window manager, keyboard remapping, database tools, and shell abbreviations.
Output: All 13 configs in chezmoi source with proper naming, .chezmoiignore updated, real files deployed to $HOME.
</objective>

<execution_context>
@/Users/stephanlv_fanaka/.claude/get-shit-done/workflows/execute-plan.md
@/Users/stephanlv_fanaka/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-basic-configs-cli-tools/08-RESEARCH.md
@.planning/phases/07-preparation/07-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add all 13 Phase 8 configs to chezmoi source</name>
  <files>
    ~/.local/share/chezmoi/dot_hushlogin
    ~/.local/share/chezmoi/dot_inputrc
    ~/.local/share/chezmoi/dot_editorconfig
    ~/.local/share/chezmoi/dot_nanorc
    ~/.local/share/chezmoi/dot_psqlrc
    ~/.local/share/chezmoi/dot_sqliterc
    ~/.local/share/chezmoi/private_dot_config/bat/config
    ~/.local/share/chezmoi/private_dot_config/lsd/config.yaml
    ~/.local/share/chezmoi/private_dot_config/btop/btop.conf
    ~/.local/share/chezmoi/private_dot_config/oh-my-posh.omp.json
    ~/.local/share/chezmoi/private_dot_config/aerospace/aerospace.toml
    ~/.local/share/chezmoi/private_dot_config/karabiner/karabiner.json
    ~/.local/share/chezmoi/private_dot_config/zsh-abbr/user-abbreviations
  </files>
  <action>
Run `chezmoi add --follow` for each of the 13 config files currently symlinked by Dotbot. MUST use `--follow` flag to resolve symlinks and capture actual file content (not the symlink itself).

Basic dotfiles (root-level, will become dot_* in chezmoi source):
```bash
chezmoi add --follow ~/.hushlogin
chezmoi add --follow ~/.inputrc
chezmoi add --follow ~/.editorconfig
chezmoi add --follow ~/.nanorc
chezmoi add --follow ~/.psqlrc
chezmoi add --follow ~/.sqliterc
```

CLI tool and app configs (.config/ directory, will become private_dot_config/* in chezmoi source):
```bash
chezmoi add --follow ~/.config/bat/config
chezmoi add --follow ~/.config/lsd/config.yaml
chezmoi add --follow --recursive ~/.config/btop
chezmoi add --follow ~/.config/oh-my-posh.omp.json
chezmoi add --follow --recursive ~/.config/aerospace
chezmoi add --follow --recursive ~/.config/karabiner
chezmoi add --follow --recursive ~/.config/zsh-abbr
```

Note on `--recursive`: Use for btop, aerospace, karabiner, and zsh-abbr to capture any additional files in those directories (themes, profiles, etc.). For single-file configs (bat, lsd, oh-my-posh), add the specific file.

After adding, verify all 13 configs appear in chezmoi source:
```bash
ls -la ~/.local/share/chezmoi/dot_hushlogin ~/.local/share/chezmoi/dot_inputrc ~/.local/share/chezmoi/dot_editorconfig ~/.local/share/chezmoi/dot_nanorc ~/.local/share/chezmoi/dot_psqlrc ~/.local/share/chezmoi/dot_sqliterc
ls -la ~/.local/share/chezmoi/private_dot_config/bat/config ~/.local/share/chezmoi/private_dot_config/lsd/config.yaml ~/.local/share/chezmoi/private_dot_config/btop/btop.conf
ls -la ~/.local/share/chezmoi/private_dot_config/oh-my-posh.omp.json
ls -la ~/.local/share/chezmoi/private_dot_config/aerospace/aerospace.toml
ls -la ~/.local/share/chezmoi/private_dot_config/karabiner/karabiner.json
ls -la ~/.local/share/chezmoi/private_dot_config/zsh-abbr/user-abbreviations
```

If any `chezmoi add` command fails (e.g., file doesn't exist at target path), check if the Dotbot symlink is intact: `ls -la ~/.hushlogin` etc. If the symlink target points elsewhere, trace it to the correct source in `~/Projects/dotfiles-zsh/.config/`.
  </action>
  <verify>
All 13 files exist in chezmoi source:
```bash
chezmoi managed --include=files | grep -cE '(hushlogin|inputrc|editorconfig|nanorc|psqlrc|sqliterc|bat/config|lsd/config|btop/btop.conf|oh-my-posh|aerospace/aerospace|karabiner/karabiner|zsh-abbr/user-abbreviations)'
```
Expected: 13 (or close — chezmoi may show slightly different path representations).

Also verify no files are symlinks in the chezmoi source:
```bash
file ~/.local/share/chezmoi/dot_hushlogin
```
Should show "ASCII text" or similar, NOT "symbolic link".
  </verify>
  <done>All 13 config files exist in chezmoi source directory with correct chezmoi naming (dot_*, private_dot_config/*) containing actual file content (not symlinks).</done>
</task>

<task type="auto">
  <name>Task 2: Update .chezmoiignore and apply configs</name>
  <files>~/.local/share/chezmoi/.chezmoiignore</files>
  <action>
Edit `~/.local/share/chezmoi/.chezmoiignore` to:

1. **Remove the entire Phase 8 pending block** (Section 8, lines 118-138). Delete from the comment header "# 8. Pending Migration — Phase 8" through all the Phase 8 ignore patterns (.hushlogin, .inputrc, .nanorc, .editorconfig, .config/bat, etc.). This allows chezmoi to manage these files.

2. **Fix the `.editorconfig` conflict in Section 2** (line 38). The `.editorconfig` pattern in Section 2 ("Repository Meta Files") also matches `$HOME/.editorconfig`, which conflicts with Phase 8 migration. Remove the `.editorconfig` line from Section 2. The repo-level .editorconfig lives at `~/Projects/dotfiles-zsh/.editorconfig` (outside chezmoi source), so this ignore pattern is unnecessary and blocks Phase 8.

3. **Renumber remaining sections** — Section 8 is gone, so Sections 9-13 become Sections 8-12. Update the section numbers and comments accordingly.

4. **Verify .chezmoiignore parses correctly:**
```bash
chezmoi execute-template < ~/.local/share/chezmoi/.chezmoiignore
```
Should output without errors.

5. **Check Phase 8 files now appear as managed:**
```bash
chezmoi managed --include=files | grep -E '(hushlogin|inputrc|editorconfig|nanorc|psqlrc|sqliterc|bat|lsd|btop|oh-my-posh|aerospace|karabiner|zsh-abbr)'
```
All 13 configs should appear.

6. **Preview and apply:**
```bash
chezmoi diff
chezmoi apply
```

7. **Verify deployed files are real files, not symlinks:**
```bash
ls -la ~/.hushlogin ~/.inputrc ~/.editorconfig ~/.nanorc ~/.psqlrc ~/.sqliterc
ls -la ~/.config/bat/config ~/.config/lsd/config.yaml ~/.config/btop/btop.conf
ls -la ~/.config/oh-my-posh.omp.json ~/.config/aerospace/aerospace.toml
ls -la ~/.config/karabiner/karabiner.json ~/.config/zsh-abbr/user-abbreviations
```
All should show regular files (no `->` symlink arrows).
  </action>
  <verify>
```bash
# Phase 8 files managed by chezmoi
chezmoi managed --include=files | grep -c hushlogin  # Expected: 1

# Files deployed as real files (not symlinks)
test -f ~/.hushlogin && ! test -L ~/.hushlogin && echo "OK: real file" || echo "FAIL: still symlink"
test -f ~/.config/bat/config && ! test -L ~/.config/bat/config && echo "OK: real file" || echo "FAIL: still symlink"

# .chezmoiignore has no Phase 8 pending section
grep -c "Phase 8" ~/.local/share/chezmoi/.chezmoiignore  # Expected: 0
```
  </verify>
  <done>Phase 8 ignore block removed from .chezmoiignore, .editorconfig Section 2 conflict resolved, all 13 configs deployed as real files via chezmoi apply, no Dotbot symlinks remain for Phase 8 files.</done>
</task>

</tasks>

<verification>
1. `chezmoi managed --include=files` shows all 13 Phase 8 configs
2. `chezmoi diff` shows no pending changes for Phase 8 files
3. All deployed files are regular files (not symlinks): `! test -L ~/.hushlogin`
4. `.chezmoiignore` has no "Phase 8" section remaining
5. `.chezmoiignore` renders without template errors: `chezmoi execute-template < ~/.local/share/chezmoi/.chezmoiignore`
</verification>

<success_criteria>
- All 13 configs added to chezmoi source with correct naming
- Phase 8 .chezmoiignore block fully removed
- Section 2 .editorconfig conflict resolved
- `chezmoi apply` deploys real files to correct $HOME paths
- No Dotbot symlinks remain for Phase 8 configs
</success_criteria>

<output>
After completion, create `.planning/phases/08-basic-configs-cli-tools/08-01-SUMMARY.md`
</output>
