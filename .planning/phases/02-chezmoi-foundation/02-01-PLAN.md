---
phase: 02-chezmoi-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - ~/.local/share/chezmoi/.chezmoiignore
  - ~/.config/chezmoi/chezmoi.toml
autonomous: true

must_haves:
  truths:
    - "chezmoi command is available in shell"
    - "chezmoi source directory exists at ~/.local/share/chezmoi"
    - "chezmoi doctor reports no errors"
  artifacts:
    - path: "~/.local/share/chezmoi"
      provides: "chezmoi source directory"
    - path: "~/.config/chezmoi/chezmoi.toml"
      provides: "chezmoi configuration for IDE workflow"
      contains: "autoCommit = true"
    - path: "~/.local/share/chezmoi/.chezmoiignore"
      provides: "ignore patterns for incremental migration"
      contains: ".config/nvim"
  key_links:
    - from: "chezmoi"
      to: "~/.local/share/chezmoi"
      via: "chezmoi init"
      pattern: "source-dir.*local/share/chezmoi"
---

<objective>
Install chezmoi and initialise the source directory with configuration for IDE-friendly workflow.

Purpose: Establish chezmoi as the foundation for dotfiles management before migrating any files.
Output: Working chezmoi installation with source directory and .chezmoiignore for incremental migration.
</objective>

<execution_context>
@/Users/stephanlv_fanaka/.claude/get-shit-done/workflows/execute-plan.md
@/Users/stephanlv_fanaka/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-chezmoi-foundation/02-RESEARCH.md
@.planning/phases/02-chezmoi-foundation/02-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install chezmoi via Homebrew</name>
  <files>None (package installation)</files>
  <action>
    Install chezmoi using Homebrew:
    ```bash
    brew install chezmoi
    ```

    Verify installation:
    ```bash
    chezmoi --version
    ```

    Expected: chezmoi version 2.x (2.69.3 or newer)
  </action>
  <verify>Run `chezmoi --version` - should return version number without error</verify>
  <done>chezmoi command available in PATH and returns version</done>
</task>

<task type="auto">
  <name>Task 2: Initialise chezmoi source directory and configuration</name>
  <files>~/.local/share/chezmoi, ~/.config/chezmoi/chezmoi.toml</files>
  <action>
    1. Initialise chezmoi (creates source directory at default location):
    ```bash
    chezmoi init
    ```

    2. Create chezmoi configuration for IDE-friendly workflow at `~/.config/chezmoi/chezmoi.toml`:
    ```toml
    # chezmoi configuration
    # IDE-friendly workflow: edit in source, manually apply

    [edit]
      # Don't auto-apply on edit (prefer manual chezmoi apply)
      apply = false

    [git]
      # Auto-commit changes to source directory
      autoCommit = true
      # Don't auto-push (prevents accidental secret exposure)
      # Enable in Phase 6 after secret management
      autoPush = false

    [diff]
      # Use delta for better diff output (if installed)
      pager = "delta"
    ```

    3. Verify initialisation:
    ```bash
    chezmoi doctor
    ```

    Expected: All checks pass (git installed, source directory exists)
  </action>
  <verify>Run `chezmoi doctor` - all checks should pass, no errors</verify>
  <done>chezmoi source directory exists at ~/.local/share/chezmoi with configuration file</done>
</task>

<task type="auto">
  <name>Task 3: Create .chezmoiignore for incremental migration</name>
  <files>~/.local/share/chezmoi/.chezmoiignore</files>
  <action>
    Create `.chezmoiignore` file in chezmoi source directory to exclude files still managed by Dotbot.

    Write to `~/.local/share/chezmoi/.chezmoiignore`:
    ```
    # .chezmoiignore
    # Files that chezmoi should NOT manage (still managed by Dotbot)
    # Updated during migration - remove entries as files are migrated

    # Editor configs (unmigrated)
    .config/nvim
    .config/nvim/**

    # Terminal emulator configs (unmigrated)
    .config/aerospace
    .config/aerospace/**
    .config/kitty
    .config/kitty/**
    .config/ghostty
    .config/ghostty/**
    .wezterm.lua

    # Tool configs (unmigrated)
    .config/atuin
    .config/atuin/**
    .config/bat
    .config/bat/**
    .config/btop
    .config/btop/**
    .config/lsd
    .config/lsd/**
    .config/lazygit
    .config/lazygit/**
    .config/karabiner
    .config/karabiner/**
    .config/nushell
    .config/nushell/**

    # ZSH plugin manager (unmigrated)
    .zgenom
    .zgenom/**
    .config/zgenom
    .config/zgenom/**
    .config/zsh-abbr
    .config/zsh-abbr/**
    .config/oh-my-posh.omp.json

    # Claude configs (unmigrated)
    .claude
    .claude/**

    # SSH config (Phase 6 scope - secrets)
    .ssh
    .ssh/**

    # GPG config (unmigrated)
    .gnupg
    .gnupg/**

    # Database configs (unmigrated)
    .psqlrc
    .sqliterc

    # Other Dotbot-managed files
    .hushlogin
    .inputrc
    .editorconfig
    .nanorc
    .aider.conf.yml
    .finicky.js
    ```

    This ensures chezmoi only manages files explicitly migrated (Phase 2: shell files, git config).
  </action>
  <verify>Run `cat ~/.local/share/chezmoi/.chezmoiignore` - should show ignore patterns</verify>
  <done>.chezmoiignore exists with patterns for all Dotbot-managed files not being migrated in Phase 2</done>
</task>

</tasks>

<verification>
1. `chezmoi --version` returns version 2.x
2. `chezmoi doctor` shows all checks passing
3. `ls ~/.local/share/chezmoi/` shows source directory exists
4. `cat ~/.config/chezmoi/chezmoi.toml` shows IDE-friendly configuration
5. `cat ~/.local/share/chezmoi/.chezmoiignore` shows ignore patterns
</verification>

<success_criteria>
- chezmoi installed and available in PATH
- chezmoi source directory initialised at ~/.local/share/chezmoi
- chezmoi configuration set for manual-apply IDE workflow (autoCommit=true, autoPush=false)
- .chezmoiignore created with patterns for all files not being migrated in Phase 2
</success_criteria>

<output>
After completion, create `.planning/phases/02-chezmoi-foundation/02-01-SUMMARY.md`
</output>
