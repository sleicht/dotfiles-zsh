---
phase: 13-remove-legacy-config-files
plan: 02
type: execute
wave: 2
depends_on: ["13-01"]
files_modified:
  - .config/aerospace/
  - .config/atuin/
  - .config/bat/
  - .config/btop/
  - .config/claude/
  - .config/ghostty/
  - .config/git/
  - .config/karabiner/
  - .config/lsd/
  - .config/zsh-abbr/
  - .config/aider.conf.yml
  - .config/editorconfig
  - .config/finicky.js
  - .config/gpgagent
  - .config/hushlogin
  - .config/inputrc
  - .config/kitty.conf
  - .config/lazygit.yml
  - .config/nanorc
  - .config/oh-my-posh.omp.json
  - .config/psqlrc
  - .config/sqliterc
  - .config/ssh_config
  - .config/wezterm.lua
  - .config/zprofile
  - .config/zshenv
  - .config/zshrc
  - zsh.d/
  - Brewfile
  - Brewfile_Client
  - Brewfile_Fanaka
  - .gitignore
autonomous: true

must_haves:
  truths:
    - "Repository contains no legacy .config/ directories from Dotbot era"
    - "Repository contains no legacy .config/ flat files from Dotbot era"
    - "Repository contains no redundant zsh.d/ directory"
    - "Repository contains no legacy Brewfiles"
    - "zsh.d/ and Brewfile* are in .gitignore to prevent re-creation"
    - "Shell loads correctly after all deletions"
    - "chezmoi apply succeeds after all deletions"
  artifacts:
    - path: ".gitignore"
      provides: "Updated gitignore with zsh.d/ and Brewfile* entries"
      contains: "zsh.d/"
  key_links:
    - from: ".planning/phases/13-remove-legacy-config-files/13-SCAN-REPORT.md"
      to: "git rm commands"
      via: "Only SAFE files from scan report are deleted"
      pattern: "SAFE"
---

<objective>
Delete all legacy files identified as SAFE in the scan report, with one commit per category and a smoke test after each.

Purpose: Clean the repository of all Dotbot-era artifacts so it reflects only chezmoi-managed reality.
Output: 4 commits removing legacy directories, flat files, zsh.d/, and Brewfiles. Updated .gitignore.
</objective>

<execution_context>
@/Users/stephanlv_fanaka/.claude/get-shit-done/workflows/execute-plan.md
@/Users/stephanlv_fanaka/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-remove-legacy-config-files/13-CONTEXT.md
@.planning/phases/13-remove-legacy-config-files/13-SCAN-REPORT.md
@.planning/phases/13-remove-legacy-config-files/13-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove legacy .config/ directories and flat files</name>
  <files>
    .config/aerospace/
    .config/atuin/
    .config/bat/
    .config/btop/
    .config/claude/
    .config/ghostty/
    .config/git/
    .config/karabiner/
    .config/lsd/
    .config/zsh-abbr/
    .config/aider.conf.yml
    .config/editorconfig
    .config/finicky.js
    .config/gpgagent
    .config/hushlogin
    .config/inputrc
    .config/kitty.conf
    .config/lazygit.yml
    .config/nanorc
    .config/oh-my-posh.omp.json
    .config/psqlrc
    .config/sqliterc
    .config/ssh_config
    .config/wezterm.lua
    .config/zprofile
    .config/zshenv
    .config/zshrc
  </files>
  <action>
IMPORTANT: Before deleting, read the scan report (13-SCAN-REPORT.md). Only delete files marked SAFE. If any file is BLOCKED, skip it and note in the summary.

Do NOT delete `.config/profile` — that is Phase 14 scope.

**Commit 1 — Legacy .config/ directories (LEGACY-01):**
```bash
git rm -r .config/aerospace .config/atuin .config/bat .config/btop .config/claude .config/ghostty .config/git .config/karabiner .config/lsd .config/zsh-abbr
```
Commit message: `chore(13): remove 10 legacy .config/ directories`
Smoke test: Run `zsh -i -c 'echo ok' && chezmoi apply --dry-run` to verify shell loads and chezmoi is happy.
If smoke test fails: fix forward (keep deletion, fix what broke, commit fix separately).

**Commit 2 — Legacy .config/ flat files (LEGACY-02):**
```bash
git rm .config/aider.conf.yml .config/editorconfig .config/finicky.js .config/gpgagent .config/hushlogin .config/inputrc .config/kitty.conf .config/lazygit.yml .config/nanorc .config/oh-my-posh.omp.json .config/psqlrc .config/sqliterc .config/ssh_config .config/wezterm.lua .config/zprofile .config/zshenv .config/zshrc
```
Commit message: `chore(13): remove 17 legacy .config/ flat files`
Smoke test: Run `zsh -i -c 'echo ok' && chezmoi apply --dry-run` again.
If smoke test fails: fix forward.

Per user decision: one commit per category, smoke test after each.
  </action>
  <verify>
- `ls .config/` shows only `.config/profile` and `.config/nushell/` (if present) — no legacy directories or flat files remain
- `git log --oneline -2` shows two separate commits for directories and flat files
- `zsh -i -c 'echo ok'` exits 0
- `chezmoi apply --dry-run` exits 0
  </verify>
  <done>
All 10 legacy .config/ directories and all 17 legacy .config/ flat files removed from the repository in 2 separate commits. Shell and chezmoi verified working after each deletion.
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove zsh.d/ directory and legacy Brewfiles, update .gitignore</name>
  <files>
    zsh.d/
    Brewfile
    Brewfile_Client
    Brewfile_Fanaka
    .gitignore
  </files>
  <action>
IMPORTANT: Read the scan report first. Only delete files marked SAFE. Skip any BLOCKED files.

**Commit 3 — Redundant zsh.d/ directory (LEGACY-04):**
1. `git rm -r zsh.d/`
2. Add `zsh.d/` to `.gitignore` (per user decision: prevent accidental re-creation)
3. Stage `.gitignore` with the zsh.d/ removal (per user decision: .gitignore update same commit as removal)
Commit message: `chore(13): remove redundant zsh.d/ directory`
Smoke test: `zsh -i -c 'echo ok' && chezmoi apply --dry-run`
If smoke test fails: fix forward.

**Commit 4 — Legacy Brewfiles (LEGACY-05):**
1. `git rm Brewfile Brewfile_Client Brewfile_Fanaka`
2. Add `Brewfile*` to `.gitignore` (per user decision: prevent accidental `brew bundle dump` commits)
3. Check for any remaining references to legacy Brewfiles in the repo:
   - install script / steps/ yaml — should already be gone (Phase 12), but verify nothing references them
   - If references found, remove them in this same commit (per user decision: install script cleanup bundled with Brewfile commit)
4. Stage `.gitignore` with the Brewfile removal
Commit message: `chore(13): remove 3 legacy Brewfiles`
Smoke test: `zsh -i -c 'echo ok' && chezmoi apply --dry-run`
If smoke test fails: fix forward.

Note on Brewfile .gitignore: User decision says "Root Brewfile: remove from repo AND gitignore (prevents accidental brew bundle dump commits)". This means add `Brewfile*` pattern which covers Brewfile, Brewfile_Client, Brewfile_Fanaka, and any future accidental dumps. Do NOT add a specific `/Brewfile` entry that would interfere — use `Brewfile*` glob.
  </action>
  <verify>
- `ls zsh.d/` returns "No such file or directory"
- `ls Brewfile*` returns "No such file or directory"
- `git log --oneline -2` shows two separate commits for zsh.d/ and Brewfiles
- `.gitignore` contains `zsh.d/` entry
- `.gitignore` contains `Brewfile*` entry
- `zsh -i -c 'echo ok'` exits 0
- `chezmoi apply --dry-run` exits 0
  </verify>
  <done>
zsh.d/ directory and 3 legacy Brewfiles removed from the repository in 2 separate commits. .gitignore updated in both commits to prevent re-creation. Shell and chezmoi verified working after each deletion. Total: 4 commits across both tasks.
  </done>
</task>

</tasks>

<verification>
After all 4 commits:
1. `ls .config/` shows only profile and nushell (if present) — no legacy directories or flat files
2. `ls zsh.d/ 2>&1` returns error (directory gone)
3. `ls Brewfile* 2>&1` returns error (files gone)
4. `.gitignore` contains zsh.d/ and Brewfile* entries
5. `zsh -i -c 'echo ok'` exits 0
6. `chezmoi apply --dry-run` exits 0
7. `git log --oneline -4` shows 4 separate commits, one per category
</verification>

<success_criteria>
Repository contains zero Dotbot-era legacy files. All 4 requirements satisfied: LEGACY-01 (10 dirs), LEGACY-02 (17 flat files), LEGACY-04 (zsh.d/), LEGACY-05 (3 Brewfiles). .gitignore prevents re-creation. Shell and chezmoi verified working.
</success_criteria>

<output>
After completion, create `.planning/phases/13-remove-legacy-config-files/13-02-SUMMARY.md`
</output>
